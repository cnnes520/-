<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>兵科準則測驗系統</title>
    <style>
        html { background-color: cornsilk; }
        body { text-align: center; font-family: sans-serif; margin: 0; padding: 0; }
        table { border: 5px double black; margin: auto; width: 100%; border-collapse: collapse; }
        td { border: 1px solid black; padding: 10px; }
        .oddRow { background-color: #CFFFCF; }
        .evenRow { background-color: #D3FCFF; }
        .correctRow { background-color: #CFFFCF !important; }
        .incorrectRow { background-color: #FF7D7A !important; }
        button { margin: 20px; font-size: 24px; cursor: pointer; padding: 10px 20px; border-radius: 8px; }
        select { margin-right: 20px; font-size: 24px; }
        label { font-size: 24px; }
        input[type="checkbox"], input[type="radio"] { width: 25px; height: 25px; vertical-align: middle; }
        p { font-weight: bold; font-size: 28px; }
        .optionLabel { margin-right: 50px; font-size: 22px; cursor: pointer; }
        #score { color: red; font-size: 32px; margin-top: 20px; }
        .left { text-align: left; }

        /* 密碼牆專屬樣式 */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: cornsilk; z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        #login-box {
            padding: 40px; border: 5px double black; background: white; border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        #pwInput { font-size: 28px; padding: 10px; width: 220px; text-align: center; border: 2px solid #333; border-radius: 5px; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div id="login-box">
            <h1 style="margin-bottom: 10px;">兵科測驗系統</h1>
            <p style="font-size: 20px; color: #555;">請輸入存取密碼</p>
            <input type="password" id="pwInput" placeholder="請輸入密碼">
            <br>
            <button onclick="checkPassword()">進入系統</button>
        </div>
    </div>

    <div id="main-content" style="display: none;">
        <div id="header">
            <h1>兵科準則測驗系統</h1>
        </div>
        <div id="container"></div>
    </div>

    <script>
        // --- 設定區 ---
        const ACCESS_PASSWORD = "1234"; // 你可以在這裡修改你的密碼

        /* 題庫資料區 */
        const data = {
            "兵科準則測驗-陸軍通資電部隊指揮教則(甲)": {
                單選: [
                    { 題目: "「支援關係」乃明示支援與被支援部隊間之責任與關係，其方式不含下列何者？", 選項: ["直接支援", "跨區支援", "一般支援", "增援"], 答案: "跨區支援" },
                    { 題目: "下列何項非「指揮程序」之主要程序？", 選項: ["任務分析及初步作戰概念", "下達預備命令及參謀作業指導", "狀況判断", "研擬各種行動方案"], 答案: "研擬各種行動方案" },
                    { 題目: "通資運用原則,下列何者為非?", 選項: ["肆應戰況", "指揮活用", "形成重點", "保持彈性", "講求節約"], 答案: "指揮活用" },
                    { 題目: "通資作業要領,下列何者為非?", 選項: ["符合要求", "早期整備", "直接通達", "優先順序", "效能管制"], 答案: "早期整備" },
                    { 題目: "下列何者非無線電通信之特性？", 選項: ["架撤迅速，機動性高", "通信距離較遠", "天線架設方式與通信效能有密切關係", "通信單位階層較廣", "不易克服地障超越敵控制區及對海空連絡"], 答案: "不易克服地障超越敵控制區及對海空連絡" },
                    { 題目: "資電優勢內涵,下列何者為非？", 選項: ["情資優勢", "電磁優勢", "設施優勢", "心理優勢", "資訊優勢"], 答案: "設施優勢" },
                    { 題目: "連絡方式下列何者為非？", 選項: ["指揮官親自查詢與協調", "參謀間電話之連絡", "運用各種通資電工具", "互派聯絡人員，保持彼此間連絡"], 答案: "參謀間電話之連絡" },
                    { 題目: "警戒基本原則，下列何者為非 ?", 選項: ["以本隊行動為準", "即時警報敵情", "與敵保持接觸", "早期發揚火力", "適時誘敵接觸"], 答案: "適時誘敵接觸" },
                    { 題目: "掩護種類區分何者錯誤?", 選項: ["前方掩護", "側翼掩護", "後方掩護", "火力掩護", "空中掩護"], 答案: "火力掩護" },
                    { 題目: "乘車行軍隊形,依戰術要求與交通狀況之不同、可區分為，下列何者為非 ?", 選項: ["疏散隊形", "密集隊形", "掩護隊形", "滲透隊形"], 答案: "掩護隊形" },
                    { 題目: "行軍成功之主要因素為何 ?", 選項: ["行軍管制", "行軍訓練", "行軍紀律", "行軍教育"], 答案: "行軍紀律" },
                    { 題目: "部隊駐止一般區分為？", 選項: ["宿營與集結", "露營與舍營", "集結與露營", "宿營與舍營"], 答案: "宿營與集結" },
                    { 題目: "宿營準備事項下列者為非？", 選項: ["下達預備命令", "擬定宿營計畫", "编組設營隊", "编組警戒兵力配置", "宿營地之偵察與配置"], 答案: "编組警戒兵力配置" },
                    { 題目: "下列何者非陸海聯合作戰之範圍？", 選項: ["近海沿岸作戰", "內陸水域作戰", "聯合防空作戰", "地面電子戰"], 答案: "地面電子戰" },
                    { 題目: "應變一般原則,下列何者為非?", 選項: ["預想預謀", "先知快報", "應變制變", "先期掌握", "臨機獨斷"], 答案: "先期掌握" },
                    { 題目: "反資敵作為主要考量因素何者為非?", 選項: ["對敵所產生之影響", "對我軍爾後作戰產生之影響", "是否造成無法控制之連鎖反應或無法彌補之後果", "攻守狀況配合", "對民生與經濟之影響"], 答案: "攻守狀況配合" },
                    { 題目: "戰力防護須貫穿？", 選項: ["作戰目標", "作戰全程", "作戰目的", "作戰狀況"], 答案: "作戰全程" },
                    { 題目: "各種通信系統應於防禦準備階段同時完成，並運用何者方法，以策安全？", 選項: ["偽裝", "掩蔽", "欺騙", "保密", "以上均是"], 答案: "以上均是" },
                    { 題目: "陣地防禦各種通信系統之運用，應以周密確實、保持彈性為原則，防禦作戰通信系統之設置應如何設置？且逐步加強之？", 選項: ["由左向右", "由右向左", "由後向前", "由前向後"], 答案: "由前向後" },
                    { 題目: "下列何者非陣地防禦通信限制因素？", 選項: ["作戰地區道路擁擠或管制、影響傳令車輛之行駛", "作戰地區阻絕設施影響線路之架設與安全", "有線電路埋設，耗用較多兵力及時間", "無線電通信使用受限制", "通信設施易遭破壞，須準備備用通信措施"], 答案: "無線電通信使用受限制" }
                ],
                多選: [
                    { 題目: "通資電部隊,同時負有何等雙重任務？", 選項: ["戰術支援", "勤務支援", "戰鬥支援", "戰技支援"], 答案: ["勤務支援", "戰鬥支援"] },
                    { 題目: "揮掌握之必要手段？", 選項: ["命令", "報告", "通報", "參謀日記"], 答案: ["命令", "報告", "通報"] },
                    { 題目: "管制方式具有下列幾種？", 選項: ["傳令管制", "臨機管制", "通信管制", "計畫管制", "協調後管制"], 答案: ["臨機管制", "計畫管制", "協調後管制"] },
                    { 題目: "通資電三大要求,一切通資作業均須符合？", 選項: ["保密", "迅速", "確實", "安全"], 答案: ["迅速", "確實", "安全"] },
                    { 題目: "資電戰運用全般作戰手段為何？以誤導及影響敵方指管系統,並有效防護及協助各軍種資訊戰,以創造資電優勢。", 選項: ["網路戰", "電子戰", "通資平臺", "戰術作為"], 答案: ["網路戰", "電子戰", "通資平臺"] }
                ]
            },
            "兵科準則測驗-陸軍通資電部隊指揮教則(乙)": {
                單選: [
                    { 題目: "臺澎防衛作戰內涵，依「」軍事戰略指導？", 選項: ["防衛固守、有效嚇阻", "防衛固守、重層嚇阻", "重層嚇阻、防衛固守", "有效嚇阻、防衛固守"], 答案: "防衛固守、重層嚇阻" },
                    { 題目: "反空(機)降作戰通資運用原則，以下何者為非？", 選項: ["預判敵登陸地區，先期完成通資系統之建立", "反空(機)降作戰通資運用應講求簡單、迅速、準確、保密", "各掃蕩部隊間須構成通信連絡以發揮完整之戰力", "通資作為須周密計畫，充分準備，靈活編組，完成線密之通資網", "對空與搜索警戒部隊之通信連絡最為重要"], 答案: "預判敵登陸地區，先期完成通資系統之建立" },
                    { 題目: "守備地區有線電、光纖等設施，應實施？", 選項: ["地下化", "複式配置", "形成迴路", "以上皆是"], 答案: "以上皆是" },
                    { 題目: "攻擊時期無線電為主要通信方法之一，應開放使用，特須注意？", 選項: ["資訊安全", "電戰措施", "通信安全", "通資保密"], 答案: "通信安全" },
                    { 題目: "陸區系統為攻擊時期主要通資手段，須有效運用通資網路，以形成何種作戰模式？", 選項: ["資訊化", "網狀化", "塊狀化", "結構化"], 答案: "網狀化" },
                    { 題目: "訊號防護，其手段為下列何者？", 選項: ["發射管制", "頻譜管理", "收發分離、誘標天線", "戰場經營", "以上皆是"], 答案: "以上皆是" },
                    { 題目: "以下何者非指揮掌握之必要手段。各級指揮官及參謀，須隨時讓上級、下級及友軍明瞭本部戰況、位置及企圖？", 選項: ["命令", "計畫", "通報", "報告"], 答案: "計畫" },
                    { 題目: "電子通信之區分下列何者為非？", 選項: ["有線電通信", "無線電通信", "微波通信", "傳令通信"], 答案: "傳令通信" },
                    { 題目: "非電子通信之區分下列何者為非？", 選項: ["傳令通信", "視號通信", "聲號通信", "動物通信", "實物通信"], 答案: "動物通信" },
                    { 題目: "下列何者非有線電通信之特性？", 選項: ["保密性較佳", "通信容量大", "接轉迅速", "機動性佳", "不易受電子干擾"], 答案: "機動性佳" },
                    { 題目: "下列何者非有線電通信裝備之組成？", 選項: ["交換裝備", "終端裝備", "電源裝備", "機動裝備", "傳輸裝備"], 答案: "機動裝備" },
                    { 題目: "下列何者非無線電電網構成方式？", 選項: ["廣播網", "對通網", "共波網", "通連網"], 答案: "通連網" },
                    { 題目: "下列何者非多波道通信之特性？", 選項: ["減少線路設施", "增加通信容量", "提高通信安全", "增加運用彈性"], 答案: "提高通信安全" },
                    { 題目: "下列何者非戰術區域通信系統之特性？", 選項: ["保密性", "機動性", "強韌性", "擴充性", "整合性"], 答案: "擴充性" },
                    { 題目: "資電作戰之特性，下列何者為非？", 選項: ["整合性", "常態性", "滲透性", "全程性", "防護性"], 答案: "常態性" },
                    { 題目: "情報區分下列何者為非？", 選項: ["戰略情報", "戰術情報", "戰鬥情報", "作戰情報", "技術情報"], 答案: "作戰情報" },
                    { 題目: "情報作業須以任務為基礎，按四大步驟，何者為非？", 選項: ["指導", "蒐集", "處理", "分析", "運用"], 答案: "分析" },
                    { 題目: "偵察種類區分下列何者為非？", 選項: ["圖上偵察", "現場偵察", "地面偵察", "空中偵察", "兩棲偵察"], 答案: "現場偵察" },
                    { 題目: "搜索種類，下列何者為非？", 選項: ["遠距離搜索", "近距離搜索", "作戰環境搜索", "戰鬥間搜索"], 答案: "作戰環境搜索" },
                    { 題目: "監控之原則下列何者為非？", 選項: ["全面多元", "時常連絡", "偵監配合", "機動彈性", "保持接觸"], 答案: "時常連絡" }
                ],
                多選: [
                    { 題目: "通資電作業規定各項目之保密等級概為何？", 選項: ["絕對機密", "密", "極機密", "機密"], 答案: ["密", "極機密", "機密"] },
                    { 題目: "追擊作戰時期各種通信系統之建立，應以何為原則？", 選項: ["彈性", "節約", "輕便", "確實", "機動"], 答案: ["輕便", "機動"] },
                    { 題目: "防禦作戰通信系統之設置應如何建立？", 選項: ["逐步加強", "由前向後", "由後向前", "由中向外"], 答案: ["逐步加強", "由前向後"] },
                    { 題目: "通資運用原則下列何者為是？", 選項: ["肆應需要", "統一活用", "形成重點", "講求節約", "保持彈性"], 答案: ["肆應需要", "統一活用", "形成重點", "講求節約", "保持彈性"] },
                    { 題目: "有線電通信裝備之組成，下列何者為何？", 選項: ["交換裝備", "終端裝備", "傳輸裝備", "電源裝備", "機動裝備"], 答案: ["交換裝備", "終端裝備", "傳輸裝備", "電源裝備"] }
                ]
            },
            "兵科準則測驗-陸軍通資電部隊指揮教則(丙)": {
                單選: [
                    { 題目: "反情報範圍何者錯誤？", 選項: ["監控", "保密", "防諜", "反破壞", "反偵搜"], 答案: "監控" },
                    { 題目: "警戒種類，下列何者為非？", 選項: ["前方警戒", "局部警戒", "對空警戒", "內部警戒", "四周警戒"], 答案: "內部警戒" },
                    { 題目: "欺敵之手段，下列何者為非？", 選項: ["佯動", "偽裝", "假設施", "欺騙"], 答案: "欺騙" },
                    { 題目: "部隊運動方式為何？", 選項: ["車輛運輸", "空中運輸", "海上運輸", "人力運輸"], 答案: "車輛運輸" },
                    { 題目: "行軍管制點不包含哪項？", 選項: ["出發點", "檢查點", "集結點", "分進點"], 答案: "集結點" },
                    { 題目: "常行軍，晝間行軍速度每小時？", 選項: ["15~17 公里", "17~20 公里", "24~32 公里", "25~34 公里"], 答案: "24~32 公里" },
                    { 題目: "常行軍，一日行軍行程約為多少公里？", 選項: ["25~50 公里", "50~100 公里", "100~200 公里", "200~250 公里"], 答案: "200~250 公里" },
                    { 題目: "強行軍一日行程，乘車為多少公里？", 選項: ["100~150 公里", "150~200 公里", "200~300 公里", "300~400 公里"], 答案: "300~400 公里" },
                    { 題目: "行軍部署編組之敘述，下列何者為非？", 選項: ["前隊", "本隊", "側衛", "後衛", "掩護部隊"], 答案: "前隊" },
                    { 題目: "行軍計畫之考量，以何為基礎？", 選項: ["命令", "任務", "敵情", "地形", "計畫"], 答案: "任務" },
                    { 題目: "下列何者非指揮所位置選定考慮事項？", 選項: ["便於指揮掌握，並適應戰況之推移", "與上、下級及友軍連絡容易", "進出、變換容易，且有足夠之疏散空間", "各種通信、資訊設施不易建立"], 答案: "各種通信、資訊設施不易建立" },
                    { 題目: "步裝(戰)砲協同作戰之通信於有線電通信建立下列敘述何者為非？", 選項: ["步兵向裝甲", "砲兵向裝甲", "砲兵向步兵", "裝甲向步兵"], 答案: "裝甲向步兵" },
                    { 題目: "步裝(戰)砲協同作戰之通信於無線電通信建立下列敘述何者為非？", 選項: ["步兵向裝甲", "裝甲向砲兵", "砲兵向步兵", "裝甲向步兵"], 答案: "步兵向裝甲" },
                    { 題目: "陸海空軍聯合作戰之通信於有線電通信之建立下列敘述何者為非？", 選項: ["陸軍向海軍", "海軍向空軍", "陸軍向空軍", "空軍向海軍"], 答案: "海軍向空軍" },
                    { 題目: "陸海空軍聯合作戰之通信於無線電通信之建立下列敘述何者為非？", 選項: ["陸軍向海軍", "空軍向海軍", "空軍向陸軍", "海軍向陸軍"], 答案: "陸軍向海軍" },
                    { 題目: "請正確排列出中繼線路架設優先順序？A.火力支援部隊、B.戰鬥支援部隊、C.預備隊、D.主要戰鬥部隊、E.勤務支援部隊、F.鄰接部隊", 選項: ["B、A、D、E、C、F", "C、A、D、F、B、E", "A、D、B、C、E、F", "D、A、B、E、C、F"], 答案: "A、D、B、C、E、F" },
                    { 題目: "請正確排列出內部電話線路架設優先順序？A.情報中心、B.作戰中心(含火協中心)、C.其他單位、D.後勤中心、E.副指揮官、參謀長及政戰主任等高勤官、F.指揮官、通資電支援中心、G.各特業參謀、H.人事中心", 選項: ["A、B、D、E、F、C、H、G", "F、A、B、E、D、H、G、C", "D、C、E、A、F、H、G、B", "C、D、F、G、H、A、B、E"], 答案: "F、A、B、E、D、H、G、C" },
                    { 題目: "如遇緊急電話，應按傳遞優先順序接轉，請正確排列出接轉順序？ A.緊急電話(緊急) B.提前電話(即刻到) C.普通電話(普通) D.防情或敵情電話(優先等級為閃急)", 選項: ["A、B、C、D", "B、C、D、A", "D、A、B、C", "C、B、A、D"], 答案: "D、A、B、C" },
                    { 題目: "宿營地區應具備條件，下列何者為非？", 選項: ["有良好道路網", "有足夠之水源", "有充分之幅員可供部隊人員與車輛疏散", "便於通信系統架設作業與維護"], 答案: "便於通信系統架設作業與維護" },
                    { 題目: "任務接替方式何者為非？", 選項: ["原地接替", "超越接替", "收容接替", "提早接替"], 答案: "提早接替" }
                ],
                多選: [
                    { 題目: "無線電通信網依電網構成式區分，以下何者為何？", 選項: ["互聯網", "共波網", "對通網", "廣播網"], 答案: ["共波網", "對通網", "廣播網"] },
                    { 題目: "守備地區戰鬥通信設施要領中主指揮所通訊中心位置，應在主陣地哪方，何者為非？", 選項: ["前方", "右方", "左方", "後方"], 答案: ["前方", "右方", "左方"] },
                    { 題目: "反擊作戰節點運用原則下列何者為是？", 選項: ["肆應戰況", "形成重點", "保持彈性", "協同指揮"], 答案: ["肆應戰況", "形成重點", "保持彈性"] },
                    { 題目: "將命令、報告、地圖、照片、影像及情報作戰有關資料、文件，由彼此雙方或多方之間傳遞，所採取之一切方法。主要區分為？", 選項: ["電子通信", "非電子通信", "公民營通信", "以上皆非"], 答案: ["電子通信", "非電子通信", "公民營通信"] },
                    { 題目: "戰力防護貫穿作戰全程，各類重要關鍵基礎設施防護及三軍戰力應掌握下列何者要訣？", 選項: ["藏", "騙", "變", "散", "動"], 答案: ["藏", "騙", "變", "散", "動"] }
                ]
            },
            "37系列無線電機-答案(甲)": {
                單選: [
                    { 題目: "RT-2000C 在定頻模式下藉由掃描功能瞭解幾個預置波道之通連狀況？", 選項: ["7個", "4個", "8個", "12個"], 答案: "8個" },
                    { 題目: "37 系列無線電機操作模式選擇旋鈕有幾種功能？", 選項: ["2種", "6種", "3種", "8種"], 答案: "6種" },
                    { 題目: "CS/VRC-194C 所需架設兩組天線至少要相距幾公尺以上？", 選項: ["1.5 公尺", "3 公尺", "4.5 公尺", "5 公尺"], 答案: "1.5 公尺" },
                    { 題目: "何者為密鑰顯示及設定鍵？", 選項: ["ID 鍵", "KEY 鍵", "FREQ 鍵", "TOD 鍵"], 答案: "KEY 鍵" },
                    { 題目: "37 系列無線電機頻率範圍為？", 選項: ["30-87.975MHz", "30-52.95MHz", "53-75.95MHz", "30-75.95 MHz"], 答案: "30-87.975MHz" },
                    { 題目: "37 系列無線電機波道間隔為？", 選項: ["30KHz", "40 KHz", "50 KHz", "25 KHz"], 答案: "25 KHz" },
                    { 題目: "37 系列無線電機波道數量為？", 選項: ["920 個", "2321 個", "2320 個", "450 個"], 答案: "2320 個" },
                    { 題目: "37 系列無線電機電源／功率選擇旋鈕有幾種模式？", 選項: ["2 種", "5 種", "3 種", "8 種"], 答案: "5 種" },
                    { 題目: "37 系列無線電機內建數據模組，符合下列那一種介面？", 選項: ["RS-232Q", "RS-232T", "RS-232C", "RS-232Z"], 答案: "RS-232C" },
                    { 題目: "37 系列使用電源供應器以操作或維護通信主機時，應設定背負型電壓及電流為何？", 選項: ["電壓 12-13V；限流 3 安培", "電壓 12-13V；限流 5 安培", "電壓 24-28V；限流 3 安培", "電壓 24-28V；限流 5 安培"], 答案: "電壓 12-13V；限流 3 安培" },
                    { 題目: "當聽到雷聲或瞬間陣風達每秒幾公尺時，通知管制台或附屬台中斷作業，待風險因素解除後繼續作業？", 選項: ["18", "21", "11", "15"], 答案: "21" },
                    { 題目: "「TOD」鍵是在下列哪種通信模式下使用？", 選項: ["跳頻模式", "定頻模式", "遙控模式", "GPS 模式"], 答案: "跳頻模式" },
                    { 題目: "下列何者表示遙控器記憶體測試？", 選項: ["中繼", "呼叫", "注入", "連測"], 答案: "連測" },
                    { 題目: "下列何者具備「連接車內通話器」之功能？", 選項: ["控制 A", "控制 B", "揚聲器接頭", "主天線"], 答案: "控制 A" },
                    { 題目: "下列何者具備「過電壓及過電流保護」之功能？", 選項: ["配接器異常指示燈", "副天線", "保險絲", "控制 B"], 答案: "保險絲" },
                    { 題目: "下列何者為 CS/VRC-193C 無線電機之組成？", 選項: ["鞭型短天線", "第二功放控制器", "電池盒罩", "背負架"], 答案: "第二功放控制器" },
                    { 題目: "當聽到雷聲或瞬間陣風達每秒幾公尺時，通知管制台或附屬台中斷作業，待風險因素解除後繼續作業？", 選項: ["18", "21", "11", "15"], 答案: "21" },
                    { 題目: "通信主機用戶識別碼「前兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: "群呼" },
                    { 題目: "數據傳輸之同位元模式選定不包括？", 選項: ["異同位", "偶同位", "奇同位", "無同位"], 答案: "異同位" },
                    { 題目: "「高」輸出功率為？", 選項: ["0.5W", "5W", "0.01W", "50W"], 答案: "5W" }
                ],
                多選: [
                    { 題目: "在「SEL」鍵，可選擇哪些方式，依所設定之 ID 碼，執行不同層級通連？", 選項: ["網呼", "不呼", "群呼", "個呼"], 答案: ["網呼", "群呼", "個呼"] },
                    { 題目: "下列何者非中繼導線之功能為何？", 選項: ["延長通信距離", "克服地障", "語音送收", "執行自動中繼轉發"], 答案: ["延長通信距離", "克服地障", "語音送收"] },
                    { 題目: "下列何者為 CS/PRC-37C 配附件？", 選項: ["車裝架底座", "天線匹配器", "可充電電池組", "數據導線"], 答案: ["天線匹配器", "可充電電池組", "數據導線"] },
                    { 題目: "下列何者不是通信主機用戶識別碼「後兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: ["總呼", "不呼", "群呼"] },
                    { 題目: "下列何者非通信主機用戶識別碼「前兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: ["個呼", "總呼", "不呼"] }
                ]
            },
            "37系列無線電機-答案(乙)": {
                單選: [
                    { 題目: "CS/PRC-37C 適用層級為何？", 選項: ["旅", "營", "連", "師"], 答案: "連" },
                    { 題目: "使用電源供應器操作 37 系列跳頻無線電機之車裝型，其電壓應設定為何？", 選項: ["12VDC", "24VDC", "18CVDC", "20VDC"], 答案: "24VDC" },
                    { 題目: "通信主機面板上的 16 鍵鍵盤區分哪些，下列何者正確？", 選項: ["功能鍵", "波道選擇旋鈕", "靜音旋鈕", "清除開關"], 答案: "功能鍵" },
                    { 題目: "何者為密鑰顯示及設定鍵？", 選項: ["ID 鍵", "KEY 鍵", "FREQ 鍵", "TOD 鍵"], 答案: "KEY 鍵" },
                    { 題目: "37 系列無線電機頻率範圍為？", 選項: ["30-87.975MHz", "30-52.95MHz", "53-75.95MHz", "30-75.95 MHz"], 答案: "30-87.975MHz" },
                    { 題目: "37 系列無線電機波道間隔為？", 選項: ["30KHz", "40 KHz", "50 KHz", "25 KHz"], 答案: "25 KHz" },
                    { 題目: "37 系列無線電機波道數量為？", 選項: ["920 個", "2321 個", "2320 個", "450 個"], 答案: "2320 個" },
                    { 題目: "37 系列無線電機電源／功率選擇旋鈕有幾種模式？", 選項: ["2 種", "5 種", "3 種", "8 種"], 答案: "5 種" },
                    { 題目: "37 系列無線電機內建數據模組，符合下列那一種介面？", 選項: ["RS-232Q", "RS-232T", "RS-232C", "RS-232Z"], 答案: "RS-232C" },
                    { 題目: "37 系列使用電源供應器以操作或維護通信主機時，應設定背負型電壓及電流為何？", 選項: ["電壓 12-13V；限流 3 安培", "電壓 12-13V；限流 5 安培", "電壓 24-28V；限流 3 安培", "電壓 24-28V；限流 5 安培"], 答案: "電壓 12-13V；限流 3 安培" },
                    { 題目: "當聽到雷聲或瞬間陣風達每秒幾公尺時，通知管制台或附屬台中斷作業，待風險因素解除後繼續作業？", 選項: ["18", "21", "11", "15"], 答案: "21" },
                    { 題目: "「TOD」鍵是在下列哪種通信模式下使用？", 選項: ["跳頻模式", "定頻模式", "遙控模式", "GPS 模式"], 答案: "跳頻模式" },
                    { 題目: "下列何者表示遙控器記憶體測試？", 選項: ["中繼", "呼叫", "注入", "連測"], 答案: "連測" },
                    { 題目: "下列何者具備「連接車內通話器」之功能？", 選項: ["控制 A", "控制 B", "揚聲器接頭", "主天線"], 答案: "控制 A" },
                    { 題目: "下列何者具備「過電壓及過電流保護」之功能？", 選項: ["配接器異常指示燈", "副天線", "保險絲", "控制 B"], 答案: "保險絲" },
                    { 題目: "下列何者為 CS/VRC-193C 無線電機之組成？", 選項: ["鞭型短天線", "第二功放控制器", "電池盒罩", "背負架"], 答案: "第二功放控制器" },
                    { 題目: "「車裝控制接頭」之接腳共幾根？", 選項: ["15", "16", "17", "18"], 答案: "17" },
                    { 題目: "通信主機用戶識別碼「前兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: "群呼" },
                    { 題目: "何者為數據傳輸速率設定？", 選項: ["RATE 鍵", "DIM 鍵", "ERF 鍵", "GPS 鍵"], 答案: "RATE 鍵" },
                    { 題目: "「高」輸出功率為？", 選項: ["0.5W", "5W", "0.01W", "50W"], 答案: "5W" }
                ],
                多選: [
                    { 題目: "下列何者為「操作功能模式選擇鈕」內之功能鍵？", 選項: ["呼叫", "定明", "注入", "中繼"], 答案: ["呼叫", "定明", "注入"] },
                    { 題目: "下列何者為「波道選擇旋鈕」內之功能鍵？", 選項: ["掃描", "波道 0-7", "注入", "清除"], 答案: ["掃描", "波道 0-7", "清除"] },
                    { 題目: "下列何者為車裝中繼型(CS/VRC-194C)之裝備組成？", 選項: ["中繼導線", "魚竿長天線", "功率放大器", "數據導線"], 答案: ["中繼導線", "魚竿長天線", "功率放大器"] },
                    { 題目: "下列何者不是通信主機用戶識別碼「後兩碼」代表為何？", 選項: ["總呼", "不呼", "群呼"], 答案: ["總呼", "不呼", "群呼"] },
                    { 題目: "下列何者非通信主機用戶識別碼「前兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: ["個呼", "總呼", "不呼"] }
                ]
            },
            "37系列無線電機-答案(丙)": {
                單選: [
                    { 題目: "「車裝控制接頭」之接腳共幾根？", 選項: ["15", "16", "17", "18"], 答案: "17" },
                    { 題目: "37 系列無線電機電源／功率選擇旋鈕有幾種模式？", 選項: ["2 種", "5 種", "3 種", "8 種"], 答案: "5 種" },
                    { 題目: "37 系列使用電源供應器以操作或維護通信主機時，應設定背負型電壓及電流為何？", 選項: ["電壓 12-13V；限流 3 安培", "電壓 12-13V；限流 5 安培", "電壓 24-28V；限流 3 安培", "電壓 24-28V；限流 5 安培"], 答案: "電壓 12-13V；限流 3 安培" },
                    { 題目: "下列何者為 CS/VRC-193C 無線電機之組成？", 選項: ["鞭型短天線", "第二功放控制器", "電池盒罩", "背負架"], 答案: "第二功放控制器" },
                    { 題目: "37 系列無線電機頻率範圍為？", 選項: ["30-87.975MHz", "30-52.95MHz", "53-75.95MHz", "30-75.95 MHz"], 答案: "30-87.975MHz" },
                    { 題目: "37 系列無線電機波道間隔為？", 選項: ["30KHz", "40 KHz", "50 KHz", "25 KHz"], 答案: "25 KHz" },
                    { 題目: "37 系列無線電機波道數量為？", 選項: ["920 個", "2321 個", "2320 個", "450 個"], 答案: "2320 個" },
                    { 題目: "使用電源供應器操作 37 系列跳頻無線電機之車裝型，其電壓應設定為何？", 選項: ["12VDC", "24VDC", "18CVDC", "20VDC"], 答案: "24VDC" },
                    { 題目: "37 系列無線電機內建數據模組，符合下列那一種介面？", 選項: ["RS-232Q", "RS-232T", "RS-232C", "RS-232Z"], 答案: "RS-232C" },
                    { 題目: "通信主機面板上的 16 鍵鍵盤區分哪些，下列何者正確？", 選項: ["功能鍵", "波道選擇旋鈕", "靜音旋鈕", "清除開關"], 答案: "功能鍵" },
                    { 題目: "當聽到雷聲或瞬間陣風達每秒幾公尺時，通知管制台或附屬台中斷作業，待風險因素解除後繼續作業？", 選項: ["18", "21", "11", "15"], 答案: "21" },
                    { 題目: "「TOD」鍵是在下列哪種通信模式下使用？", 選項: ["跳頻模式", "定頻模式", "遙控模式", "GPS 模式"], 答案: "跳頻模式" },
                    { 題目: "下列何者表示遙控器記憶體測試？", 選項: ["中繼", "呼叫", "注入", "連測"], 答案: "連測" },
                    { 題目: "下列何者具備「連接車內通話器」之功能？", 選項: ["控制 A", "控制 B", "揚聲器接頭", "主天線"], 答案: "控制 A" },
                    { 題目: "下列何者具備「過電壓及過電流保護」之功能？", 選項: ["配接器異常指示燈", "副天線", "保險絲", "控制 B"], 答案: "保險絲" },
                    { 題目: "何者為密鑰顯示及設定鍵？", 選項: ["ID 鍵", "KEY 鍵", "FREQ 鍵", "TOD 鍵"], 答案: "KEY 鍵" },
                    { 題目: "CS/PRC-37C 適用層級為何？", 選項: ["旅", "營", "連", "師"], 答案: "連" },
                    { 題目: "通信主機用戶識別碼「前兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: "群呼" },
                    { 題目: "何者為數據傳輸速率設定？", 選項: ["RATE 鍵", "DIM 鍵", "ERF 鍵", "GPS 鍵"], 答案: "RATE 鍵" },
                    { 題目: "「高」輸出功率為？", 選項: ["0.5W", "5W", "0.01W", "50W"], 答案: "5W" }
                ],
                多選: [
                    { 題目: "下列何者為「操作功能模式選擇鈕」內之功能鍵？", 選項: ["呼叫", "定明", "注入", "中繼"], 答案: ["呼叫", "定明", "注入"] },
                    { 題目: "下列何者為 CS/VRC-191C 無線電機之組成？", 選項: ["背負架", "車裝控制器", "車裝架底座", "功率放大器", "以上皆是"], 答案: ["車裝控制器", "車裝架底座", "功率放大器"] },
                    { 題目: "遙控器最大遙控距離，下列敘述何者為非？", 選項: ["雙絞線(WD-1/TT)為 3.2 公里", "單芯線(WD-1A/TT)為 1.6 公里", "平行線(WD-1A/TT)為 2 公里", "三絞線(WD-1/TT)為 3 公里"], 答案: ["單芯線(WD-1A/TT)為 1.6 公里", "平行線(WD-1A/TT)為 2 公里", "三絞線(WD-1/TT)為 3 公里"] },
                    { 題目: "下列何者不是通信主機用戶識別碼「後兩碼」代表為何？", 選項: ["總呼", "不呼", "群呼"], 答案: ["總呼", "不呼", "群呼"] },
                    { 題目: "下列何者非通信主機用戶識別碼「前兩碼」代表為何？", 選項: ["個呼", "總呼", "不呼", "群呼"], 答案: ["個呼", "總呼", "不呼"] }
                ]
            },
            "兵科準則測驗": { 是非: [], 單選: [], 多選: [] }
        };

        // --- 核心邏輯 ---
        let cQuestionNum = 0, sQuestionNum = 20, mQuestionNum = 5;
        let scorePerC = 0, scorePerS = 4, scorePerM = 4, totalScore = 0;
        let questions = { "是非": [], "單選": [], "多選": [] };
        let fullQuestionMode = false;

        // 登入檢查
        function checkPassword() {
            const input = document.getElementById("pwInput").value;
            if (input === ACCESS_PASSWORD) {
                document.getElementById("login-overlay").style.display = "none";
                document.getElementById("main-content").style.display = "block";
                showInitialPage();
            } else {
                alert("密碼錯誤，請重新輸入！");
                document.getElementById("pwInput").value = "";
            }
        }

        // 支援 Enter 登入
        document.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                const overlay = document.getElementById("login-overlay");
                if (overlay && overlay.style.display !== "none") {
                    checkPassword();
                }
            }
        });

        function prepareQuestions(subject, full, shuffle) {
            fullQuestionMode = full;
            questions = { "是非": [], "單選": [], "多選": [] };
            
            if (subject === "兵科準則測驗") {
                // 自動合併所有教則與37系列的題目
                for (let key in data) {
                    if (key !== "兵科準則測驗") {
                        let suffix = key.split("-")[1] || key;
                        ["是非", "單選", "多選"].forEach(type => {
                            if (data[key][type]) {
                                data[key][type].forEach(q => {
                                    let newQ = JSON.parse(JSON.stringify(q));
                                    newQ["題目"] += ` 《${suffix}》`;
                                    questions[type].push(newQ);
                                });
                            }
                        });
                    }
                }
            } else {
                questions = JSON.parse(JSON.stringify(data[subject]));
            }

            // 分數設定
            if (!full) {
                if (questions["是非"] && questions["是非"].length > 0) {
                    cQuestionNum = 10; sQuestionNum = 20; mQuestionNum = 5;
                    scorePerC = 2; scorePerS = 3; scorePerM = 4;
                } else {
                    cQuestionNum = 0; sQuestionNum = 20; mQuestionNum = 5;
                    scorePerC = 0; scorePerS = 4; scorePerM = 4;
                }
            } else {
                cQuestionNum = (questions["是非"] || []).length;
                sQuestionNum = questions["單選"].length;
                mQuestionNum = questions["多選"].length;
            }

            const shuffleArray = (arr) => {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]];
                }
            };

            shuffleArray(questions["是非"] || []);
            shuffleArray(questions["單選"]);
            shuffleArray(questions["多選"]);

            if (shuffle) {
                questions["單選"].forEach(q => shuffleArray(q["選項"]));
                questions["多選"].forEach(q => shuffleArray(q["選項"]));
            }
        }

        function isArrEqual(arr1, arr2) {
            if (arr1.length !== arr2.length) return false;
            return [...arr1].sort().every((val, index) => val === [...arr2].sort()[index]);
        }

        function cleanPage() { document.getElementById("container").innerHTML = ""; }

        function showInitialPage() {
            totalScore = 0;
            const container = document.getElementById("container");
            cleanPage();
            
            let label = document.createElement("label");
            label.innerHTML = "請選擇科目: ";
            let dropDown = document.createElement("select");
            dropDown.id = "subject";
            for (let subject in data) {
                let opt = document.createElement("option");
                opt.value = subject; opt.innerHTML = subject;
                dropDown.appendChild(opt);
            }
            container.appendChild(label);
            container.appendChild(dropDown);
            container.appendChild(document.createElement("br"));

            const createOption = (id, text) => {
                let cb = document.createElement("input"); cb.type = "checkbox"; cb.id = id;
                let lb = document.createElement("label"); lb.htmlFor = id; lb.innerHTML = text;
                container.appendChild(cb); container.appendChild(lb);
                container.appendChild(document.createElement("br"));
            };

            createOption("fullQuestion", " K書模式 (全出/不計分)");
            createOption("needShuffle", " 測驗模式 (選項打亂)");

            let btn = document.createElement("button");
            btn.innerHTML = "進入系統";
            btn.onclick = () => {
                prepareQuestions(
                    document.getElementById("subject").value,
                    document.getElementById("fullQuestion").checked,
                    document.getElementById("needShuffle").checked
                );
                cleanPage();
                showQuestionPage();
            };
            container.appendChild(btn);
        }

        function showQuestionPage() {
            const table = document.createElement("table");
            document.getElementById("container").appendChild(table);

            const renderSec = (type, num, prefix, isRadio) => {
                if (!questions[type] || num <= 0) return;
                createHeader(table, type, prefix + "H", "correctTd" + prefix);
                for (let i = 0; i < Math.min(num, questions[type].length); i++) {
                    let tr = createRow(i, prefix + "r", (i % 2 === 0 ? "oddRow" : "evenRow"));
                    tr.appendChild(createCell(i + 1 + "."));
                    tr.appendChild(createAnswerCell(prefix + "t" + i, prefix + "p" + i));
                    
                    let tdQ = document.createElement("td"); tdQ.className = "left";
                    if(type === "是非") {
                        let sel = document.createElement("select"); sel.id = "sc" + i;
                        ["", "O", "X"].forEach(v => { let o = document.createElement("option"); o.value = v; o.innerHTML = v; sel.appendChild(o); });
                        tdQ.appendChild(sel);
                        let lbl = document.createElement("label"); lbl.innerHTML = " " + questions[type][i]["題目"];
                        tdQ.appendChild(lbl);
                    } else {
                        let p = document.createElement("p"); p.innerHTML = questions[type][i]["題目"]; tdQ.appendChild(p);
                        questions[type][i]["選項"].forEach((optVal, j) => {
                            let inp = document.createElement("input");
                            inp.type = isRadio ? "radio" : "checkbox";
                            inp.name = prefix + i; inp.id = `${prefix}${i}_${j}`; inp.value = optVal;
                            let lbl = document.createElement("label");
                            lbl.className = "optionLabel"; lbl.htmlFor = inp.id; lbl.innerHTML = `${j+1}. ${optVal}`;
                            tdQ.appendChild(inp); tdQ.appendChild(lbl);
                        });
                    }
                    tr.appendChild(tdQ); table.appendChild(tr);
                }
            };

            renderSec("是非", cQuestionNum, "c", false);
            renderSec("單選", sQuestionNum, "s", true);
            renderSec("多選", mQuestionNum, "m", false);

            let scoreP = document.createElement("p"); scoreP.id = "score"; scoreP.style.display = "none";
            document.getElementById("container").appendChild(scoreP);

            let btnBack = document.createElement("button");
            btnBack.innerHTML = "回首頁"; btnBack.onclick = () => { cleanPage(); showInitialPage(); };
            document.getElementById("container").appendChild(btnBack);

            let btnResult = document.createElement("button");
            btnResult.id = "resultButton"; btnResult.innerHTML = "計算成績";
            btnResult.onclick = showResult;
            document.getElementById("container").appendChild(btnResult);
        }

        function createHeader(table, title, hId, correctId) {
            let tr1 = document.createElement("tr");
            let td1 = document.createElement("td"); td1.colSpan = 2; td1.id = hId;
            td1.innerHTML = `<h2>${title}</h2>`; tr1.appendChild(td1); table.appendChild(tr1);
            let tr2 = document.createElement("tr");
            tr2.innerHTML = `<td><h3>項次</h3></td><td id="${correctId}" style="display:none"><h3>正確答案</h3></td><td><h3>題目</h3></td>`;
            table.appendChild(tr2);
        }

        function createRow(i, prefix, cls) { let tr = document.createElement("tr"); tr.id = prefix + i; tr.className = cls; return tr; }
        function createCell(text) { let td = document.createElement("td"); td.innerHTML = `<p>${text}</p>`; return td; }
        function createAnswerCell(tdId, pId) {
            let td = document.createElement("td"); td.id = tdId; td.style.display = "none";
            let p = document.createElement("p"); p.id = pId; td.appendChild(p); return td;
        }

        function showResult() {
            totalScore = 0;
            let cInc = 0, sInc = 0, mInc = 0;
            document.querySelectorAll("input, select, #resultButton").forEach(el => el.disabled = true);
            ["correctTdc", "correctTds", "correctTdm"].forEach(id => { if(document.getElementById(id)) document.getElementById(id).style.display = ""; });
            ["cH", "sH", "mH"].forEach(id => { if(document.getElementById(id)) document.getElementById(id).colSpan = 3; });

            // 是非
            for (let i = 0; i < Math.min(cQuestionNum, (questions["是非"]||[]).length); i++) {
                document.getElementById("ct" + i).style.display = "";
                let ans = questions["是非"][i]["答案"];
                document.getElementById("cp" + i).innerHTML = ans;
                if (document.getElementById("sc" + i).value === ans) {
                    document.getElementById("cr" + i).className = "correctRow"; totalScore += scorePerC;
                } else { document.getElementById("cr" + i).className = "incorrectRow"; cInc++; }
            }
            // 單選
            for (let i = 0; i < Math.min(sQuestionNum, questions["單選"].length); i++) {
                document.getElementById("st" + i).style.display = "";
                let correctVal = questions["單選"][i]["答案"];
                document.getElementById("sp" + i).innerHTML = questions["單選"][i]["選項"].indexOf(correctVal) + 1;
                let checked = document.querySelector(`input[name='s${i}']:checked`);
                if (checked && checked.value === correctVal) {
                    document.getElementById("sr" + i).className = "correctRow"; totalScore += scorePerS;
                } else { document.getElementById("sr" + i).className = "incorrectRow"; sInc++; }
            }
            // 多選
            for (let i = 0; i < Math.min(mQuestionNum, questions["多選"].length); i++) {
                document.getElementById("mt" + i).style.display = "";
                let correctArr = questions["多選"][i]["答案"];
                let correctIndices = correctArr.map(v => questions["多選"][i]["選項"].indexOf(v) + 1).sort();
                document.getElementById("mp" + i).innerHTML = correctIndices.join("");
                let userArr = Array.from(document.querySelectorAll(`input[name='m${i}']:checked`)).map(cb => cb.value);
                if (isArrEqual(userArr, correctArr)) {
                    document.getElementById("mr" + i).className = "correctRow"; totalScore += scorePerM;
                } else { document.getElementById("mr" + i).className = "incorrectRow"; mInc++; }
            }

            let scoreBox = document.getElementById("score");
            scoreBox.style.display = "block";
            scoreBox.innerHTML = fullQuestionMode ? `錯誤統計：是非 ${cInc} / 單選 ${sInc} / 多選 ${mInc}` : `測驗得分：${totalScore} 分`;
            window.scrollTo(0, document.body.scrollHeight);
        }
    </script>
</body>
</html>